<!doctype html>
<html lang="it">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Annotator</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f7fafc;
    }

    html {
      margin: 0;
      padding: 0;
    }

    .app-container {
      display: flex;
      flex-direction: column;
    }

    .toolbar {
      background: white;
      border-bottom: 2px solid #e2e8f0;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      gap: 16px;
      flex-wrap: wrap;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .toolbar-title {
      font-size: 20px;
      font-weight: 700;
      color: #2d3748;
      margin-right: auto;
    }

    .toolbar-group {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 0 12px;
      border-left: 2px solid #e2e8f0;
    }

    .toolbar-group:first-of-type {
      border-left: none;
      padding-left: 0;
    }

    .btn {
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
      white-space: nowrap;
    }

    .btn-primary {
      background: #3182ce;
      color: white;
    }

    .btn-primary:hover {
      background: #2c5282;
      transform: translateY(-1px);
    }

    .btn-success {
      background: #38a169;
      color: white;
    }

    .btn-success:hover {
      background: #2f855a;
      transform: translateY(-1px);
    }

    .btn-tool {
      background: #edf2f7;
      color: #4a5568;
      border: 2px solid transparent;
    }

    .btn-tool:hover {
      background: #e2e8f0;
    }

    .btn-tool.active {
      background: #fed7d7;
      color: #c53030;
      border-color: #fc8181;
    }

    .btn-danger {
      background: #fc8181;
      color: white;
    }

    .btn-danger:hover {
      background: #f56565;
    }

    .color-picker-wrapper {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .color-picker-wrapper label {
      font-size: 13px;
      font-weight: 600;
      color: #4a5568;
    }

    .color-picker-wrapper input[type="color"] {
      width: 40px;
      height: 40px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      cursor: pointer;
    }

    .size-control {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .size-control label {
      font-size: 13px;
      font-weight: 600;
      color: #4a5568;
    }

    .size-control input[type="range"] {
      width: 100px;
    }

    .size-value {
      font-size: 13px;
      font-weight: 700;
      color: #2d3748;
      min-width: 25px;
    }

    .page-nav {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .page-nav button {
      padding: 8px 12px;
      background: #edf2f7;
      color: #4a5568;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      font-size: 13px;
    }

    .page-nav button:hover:not(:disabled) {
      background: #e2e8f0;
    }

    .page-nav button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .page-info {
      font-size: 13px;
      font-weight: 600;
      color: #4a5568;
      padding: 8px 12px;
      background: #edf2f7;
      border-radius: 6px;
    }

    .main-content {
      background: #f7fafc;
      overflow: auto;
      padding: 30px;
      text-align: center;
    }

    .canvas-wrapper {
      position: relative;
      display: inline-block;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
      border-radius: 4px;
      overflow: hidden;
    }

    #pdfCanvas {
      display: block;
      max-width: 100%;
    }

    #annotationCanvas {
      position: absolute;
      top: 0;
      left: 0;
      cursor: default;
    }

    #annotationCanvas.drawing {
      cursor: crosshair;
    }

    #annotationCanvas.text {
      cursor: text;
    }

    #annotationCanvas.eraser {
      cursor: cell;
    }

    .empty-state {
      text-align: center;
      color: #a0aec0;
    }

    .empty-state-icon {
      font-size: 100px;
      margin-bottom: 20px;
    }

    .empty-state h2 {
      font-size: 24px;
      color: #4a5568;
      margin: 0 0 10px 0;
    }

    .empty-state p {
      font-size: 16px;
      margin: 0;
    }

    input[type="file"] {
      display: none;
    }

    @media (max-width: 768px) {
      .toolbar {
        padding: 10px;
        gap: 8px;
      }

      .toolbar-title {
        font-size: 16px;
        width: 100%;
        margin-bottom: 8px;
      }

      .toolbar-group {
        padding: 0 8px;
        flex-wrap: wrap;
      }

      .btn {
        padding: 8px 12px;
        font-size: 12px;
      }

      .main-content {
        padding: 15px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-container">
   <header class="toolbar">
    <div class="toolbar-title" id="appTitle">
     üìÑ PDF Annotator
    </div>
    <div class="toolbar-group"><input type="file" id="fileInput" accept="application/pdf"> <button class="btn btn-primary" id="uploadBtn">üìÅ Carica PDF</button> <button class="btn btn-success" id="sampleBtn">üìÑ Esempio</button>
 <button class="btn btn-success" id="btnHindi">Hindi</button>
  <button class="btn btn-success" id="btnChinese">Chinese</button>
  <button class="btn btn-success" id="btnJapanese">Japanese</button>

    </div>
    <div class="toolbar-group" id="pageNav" style="display: none;">
     <div class="page-nav"><button id="prevBtn">‚óÄ Prec</button>
      <div class="page-info" id="pageInfo">
       Pagina 1 di 1
      </div><button id="nextBtn">Succ ‚ñ∂</button>
     </div>
    </div>
    <div class="toolbar-group"><button class="btn btn-tool" id="drawBtn">‚úèÔ∏è Disegna</button> <button class="btn btn-tool" id="textBtn">üìù Testo</button> <button class="btn btn-tool" id="eraserBtn">üßπ Gomma</button>
    </div>
    <div class="toolbar-group">
     <div class="color-picker-wrapper"><label for="colorPicker">Colore</label> <input type="color" id="colorPicker" value="#e53e3e">
     </div>
    </div>
    <div class="toolbar-group">
     <div class="size-control"><label for="sizeSlider">Spessore</label> <input type="range" id="sizeSlider" min="1" max="15" value="3"> <span class="size-value" id="sizeValue">3</span>
     </div>
    </div>
    <div class="toolbar-group"><button class="btn btn-danger" id="clearBtn">üóëÔ∏è Cancella</button> <button class="btn btn-primary" id="saveBtn">üíæ Salva</button>
    </div>
   </header>
   <main class="main-content" id="mainContent">
    <div class="empty-state" id="emptyState">
     <div class="empty-state-icon">
      üìÑ
     </div>
     <h2>Carica un PDF per iniziare</h2>
     <p>Clicca su "Carica PDF" o prova il PDF di esempio</p>
    </div>
    <div class="canvas-wrapper" id="canvasWrapper" style="display: none;">
     <canvas id="pdfCanvas"></canvas>
     <canvas id="annotationCanvas"></canvas>
    </div>
   </main>
  </div>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

    const defaultConfig = {
      app_title: "üìÑ PDF Annotator",
      primary_color: "#3182ce",
      secondary_color: "#38a169",
      accent_color: "#e53e3e",
      background_color: "#f7fafc",
      surface_color: "#ffffff"
    };

    let pdfDoc = null;
    let currentPage = 1;
    let totalPages = 0;
    let isDrawing = false;
    let currentTool = null;
    let currentColor = '#e53e3e';
    let currentSize = 3;
    let annotations = {};

    const pdfCanvas = document.getElementById('pdfCanvas');
    const annotationCanvas = document.getElementById('annotationCanvas');
    const pdfCtx = pdfCanvas.getContext('2d');
    const annotationCtx = annotationCanvas.getContext('2d');

    const fileInput = document.getElementById('fileInput');
    const uploadBtn = document.getElementById('uploadBtn');
    const sampleBtn = document.getElementById('sampleBtn');
    const drawBtn = document.getElementById('drawBtn');
    const textBtn = document.getElementById('textBtn');
    const eraserBtn = document.getElementById('eraserBtn');
    const colorPicker = document.getElementById('colorPicker');
    const sizeSlider = document.getElementById('sizeSlider');
    const sizeValue = document.getElementById('sizeValue');
    const clearBtn = document.getElementById('clearBtn');
    const saveBtn = document.getElementById('saveBtn');
    const emptyState = document.getElementById('emptyState');
    const canvasWrapper = document.getElementById('canvasWrapper');
    const pageNav = document.getElementById('pageNav');
    const pageInfo = document.getElementById('pageInfo');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

document.getElementById('btnHindi').addEventListener('click', () => loadPDF('pdf/hindi.pdf'));
document.getElementById('btnChinese').addEventListener('click', () => loadPDF('pdf/chinese.pdf'));
document.getElementById('btnJapanese').addEventListener('click', () => loadPDF('pdf/japanese.pdf'));

    uploadBtn.addEventListener('click', () => fileInput.click());
    fileInput.addEventListener('change', handleFileSelect);
    sampleBtn.addEventListener('click', loadSamplePDF);


    drawBtn.addEventListener('click', () => setTool('draw'));
    textBtn.addEventListener('click', () => setTool('text'));
    eraserBtn.addEventListener('click', () => setTool('eraser'));

    colorPicker.addEventListener('input', (e) => {
      currentColor = e.target.value;
    });

    sizeSlider.addEventListener('input', (e) => {
      currentSize = parseInt(e.target.value);
      sizeValue.textContent = currentSize;
    });

    clearBtn.addEventListener('click', clearAnnotations);
    saveBtn.addEventListener('click', saveAsImage);

    prevBtn.addEventListener('click', () => changePage(-1));
    nextBtn.addEventListener('click', () => changePage(1));

    annotationCanvas.addEventListener('mousedown', startDrawing);
    annotationCanvas.addEventListener('mousemove', draw);
    annotationCanvas.addEventListener('mouseup', stopDrawing);
    annotationCanvas.addEventListener('mouseleave', stopDrawing);

    annotationCanvas.addEventListener('touchstart', handleTouchStart, { passive: false });
    annotationCanvas.addEventListener('touchmove', handleTouchMove, { passive: false });
    annotationCanvas.addEventListener('touchend', stopDrawing);

    function setTool(tool) {
      if (currentTool === tool) {
        currentTool = null;
        [drawBtn, textBtn, eraserBtn].forEach(btn => btn.classList.remove('active'));
        annotationCanvas.className = '';
      } else {
        currentTool = tool;
        [drawBtn, textBtn, eraserBtn].forEach(btn => btn.classList.remove('active'));
        annotationCanvas.className = '';
        
        if (tool === 'draw') {
          drawBtn.classList.add('active');
          annotationCanvas.classList.add('drawing');
        } else if (tool === 'text') {
          textBtn.classList.add('active');
          annotationCanvas.classList.add('text');
        } else if (tool === 'eraser') {
          eraserBtn.classList.add('active');
          annotationCanvas.classList.add('eraser');
        }
      }
    }

    function handleFileSelect(e) {
      const file = e.target.files[0];
      if (file && file.type === 'application/pdf') {
        loadPDF(file);
      }
    }

    function loadSamplePDF() {
      const samplePDF = createSamplePDF();
      loadPDF(samplePDF);
    }
    
    function createSamplePDF() {
      const canvas = document.createElement('canvas');
      canvas.width = 300;
      canvas.height = 400;
      const ctx = canvas.getContext('2d');
      
      ctx.fillStyle = 'white';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      
      ctx.fillStyle = '#2d3748';
      ctx.font = 'bold 20px Arial';
      ctx.fillText('PDF Annotator', 20, 35);
      
      ctx.font = '12px Arial';
      ctx.fillText('Documento di esempio', 20, 55);
      
      ctx.strokeStyle = '#3182ce';
      ctx.lineWidth = 2;
      ctx.strokeRect(20, 75, 260, 150);
      
      ctx.fillStyle = '#3182ce';
      ctx.font = '11px Arial';
      ctx.fillText('‚úèÔ∏è Disegna', 30, 100);
      ctx.fillText('üìù Testo', 30, 125);
      ctx.fillText('üßπ Gomma', 30, 150);
      ctx.fillText('üé® Colore', 30, 175);
      ctx.fillText('üíæ Salva', 30, 200);
      
      ctx.fillStyle = '#e53e3e';
      ctx.font = 'bold 14px Arial';
      ctx.fillText('Prova a disegnare! üëá', 20, 260);
      
      ctx.strokeStyle = '#e2e8f0';
      ctx.lineWidth = 2;
      ctx.strokeRect(20, 280, 260, 100);
      
      return canvas.toDataURL('image/png');
    }

    async function loadPDF(source) {
      try {
        annotations = {};
        
        if (typeof source === 'string' && source.startsWith('data:image')) {
          const img = new Image();
          img.onload = () => {
            pdfDoc = { numPages: 1, isImage: true, imageData: img };
            totalPages = 1;
            currentPage = 1;
            renderPage(1);
          };
          img.src = source;
          return;
        }
        
        let loadingTask;
        if (source instanceof File) {
          const arrayBuffer = await source.arrayBuffer();
          loadingTask = pdfjsLib.getDocument({ data: arrayBuffer });
        } else {
          loadingTask = pdfjsLib.getDocument(source);
        }

        pdfDoc = await loadingTask.promise;
        totalPages = pdfDoc.numPages;
        currentPage = 1;
        renderPage(currentPage);
      } catch (error) {
        console.error('Errore caricamento PDF:', error);
      }
    }

    async function renderPage(pageNum) {
      saveCurrentAnnotations();
      
      if (pdfDoc.isImage) {
        const img = pdfDoc.imageData;
        pdfCanvas.width = img.width;
        pdfCanvas.height = img.height;
        annotationCanvas.width = img.width;
        annotationCanvas.height = img.height;
        pdfCtx.drawImage(img, 0, 0);
      } else {
        const page = await pdfDoc.getPage(pageNum);
        const viewport = page.getViewport({ scale: 2.5 });

        pdfCanvas.width = viewport.width;
        pdfCanvas.height = viewport.height;
        annotationCanvas.width = viewport.width;
        annotationCanvas.height = viewport.height;

        await page.render({
          canvasContext: pdfCtx,
          viewport: viewport
        }).promise;
      }
      
      emptyState.style.display = 'none';
      canvasWrapper.style.display = 'block';
      pageNav.style.display = 'flex';
      
      loadCurrentAnnotations();
      updatePageInfo();
    }

    function saveCurrentAnnotations() {
      if (annotationCanvas.width > 0) {
        annotations[currentPage] = annotationCanvas.toDataURL();
      }
    }

    function loadCurrentAnnotations() {
      annotationCtx.clearRect(0, 0, annotationCanvas.width, annotationCanvas.height);
      if (annotations[currentPage]) {
        const img = new Image();
        img.onload = () => {
          annotationCtx.drawImage(img, 0, 0);
        };
        img.src = annotations[currentPage];
      }
    }

    function changePage(delta) {
      const newPage = currentPage + delta;
      if (newPage >= 1 && newPage <= totalPages) {
        currentPage = newPage;
        renderPage(currentPage);
      }
    }

    function updatePageInfo() {
      pageInfo.textContent = `Pagina ${currentPage} di ${totalPages}`;
      prevBtn.disabled = currentPage <= 1;
      nextBtn.disabled = currentPage >= totalPages;
    }

    function getCanvasCoordinates(e) {
      const rect = annotationCanvas.getBoundingClientRect();
      const scaleX = annotationCanvas.width / rect.width;
      const scaleY = annotationCanvas.height / rect.height;
      
      let clientX, clientY;
      if (e.touches && e.touches.length > 0) {
        clientX = e.touches[0].clientX;
        clientY = e.touches[0].clientY;
      } else {
        clientX = e.clientX;
        clientY = e.clientY;
      }
      
      return {
        x: (clientX - rect.left) * scaleX,
        y: (clientY - rect.top) * scaleY
      };
    }

    function startDrawing(e) {
      if (!currentTool) return;
      
      if (currentTool === 'text') {
        addText(e);
        return;
      }
      
      isDrawing = true;
      const coords = getCanvasCoordinates(e);
      
      annotationCtx.beginPath();
      annotationCtx.moveTo(coords.x, coords.y);
    }

    function draw(e) {
      if (!isDrawing || !currentTool) return;
      
      const coords = getCanvasCoordinates(e);
      
      annotationCtx.lineWidth = currentSize * 2;
      annotationCtx.lineCap = 'round';
      annotationCtx.lineJoin = 'round';
      
      if (currentTool === 'eraser') {
        annotationCtx.globalCompositeOperation = 'destination-out';
        annotationCtx.lineWidth = currentSize * 5;
      } else if (currentTool === 'draw') {
        annotationCtx.globalCompositeOperation = 'source-over';
        annotationCtx.strokeStyle = currentColor;
      }
      
      annotationCtx.lineTo(coords.x, coords.y);
      annotationCtx.stroke();
      annotationCtx.beginPath();
      annotationCtx.moveTo(coords.x, coords.y);
    }

    function stopDrawing() {
      isDrawing = false;
      annotationCtx.beginPath();
    }

    function handleTouchStart(e) {
      e.preventDefault();
      startDrawing(e);
    }

    function handleTouchMove(e) {
      e.preventDefault();
      draw(e);
    }

    function addText(e) {
      const coords = getCanvasCoordinates(e);
      
      const textInput = document.createElement('div');
      textInput.style.position = 'fixed';
      textInput.style.top = '50%';
      textInput.style.left = '50%';
      textInput.style.transform = 'translate(-50%, -50%)';
      textInput.style.background = 'white';
      textInput.style.padding = '24px';
      textInput.style.borderRadius = '12px';
      textInput.style.boxShadow = '0 10px 40px rgba(0,0,0,0.3)';
      textInput.style.zIndex = '1000';
      textInput.innerHTML = `
        <div style="margin-bottom: 12px; font-weight: 600; color: #2d3748;">Inserisci il testo:</div>
        <input type="text" id="textInputField" style="width: 300px; padding: 10px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 14px; margin-bottom: 12px;">
        <div style="display: flex; gap: 8px;">
          <button id="textOkBtn" style="flex: 1; padding: 10px; background: #3182ce; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">OK</button>
          <button id="textCancelBtn" style="flex: 1; padding: 10px; background: #e2e8f0; color: #4a5568; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">Annulla</button>
        </div>
      `;
      
      document.body.appendChild(textInput);
      const input = document.getElementById('textInputField');
      input.focus();
      
      const addTextToCanvas = () => {
        const text = input.value.trim();
        if (text) {
          annotationCtx.globalCompositeOperation = 'source-over';
          annotationCtx.font = `${currentSize * 8}px Arial`;
          annotationCtx.fillStyle = currentColor;
          annotationCtx.fillText(text, coords.x, coords.y);
        }
        document.body.removeChild(textInput);
      };
      
      const cancel = () => {
        document.body.removeChild(textInput);
      };
      
      document.getElementById('textOkBtn').addEventListener('click', addTextToCanvas);
      document.getElementById('textCancelBtn').addEventListener('click', cancel);
      input.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') addTextToCanvas();
      });
    }

    function clearAnnotations() {
      annotationCtx.clearRect(0, 0, annotationCanvas.width, annotationCanvas.height);
      delete annotations[currentPage];
    }

    function saveAsImage() {
      saveCurrentAnnotations();
      
      const mergedCanvas = document.createElement('canvas');
      mergedCanvas.width = pdfCanvas.width;
      mergedCanvas.height = pdfCanvas.height;
      const mergedCtx = mergedCanvas.getContext('2d');
      
      mergedCtx.drawImage(pdfCanvas, 0, 0);
      mergedCtx.drawImage(annotationCanvas, 0, 0);
      
      mergedCanvas.toBlob((blob) => {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `pdf-annotato-pagina-${currentPage}.png`;
        a.click();
        URL.revokeObjectURL(url);
      });
    }

    async function onConfigChange(config) {
      const appTitle = document.getElementById('appTitle');
      appTitle.textContent = config.app_title || defaultConfig.app_title;

      const primaryColor = config.primary_color || defaultConfig.primary_color;
      const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
      const accentColor = config.accent_color || defaultConfig.accent_color;
      const backgroundColor = config.background_color || defaultConfig.background_color;
      const surfaceColor = config.surface_color || defaultConfig.surface_color;

      document.body.style.background = backgroundColor;
      document.querySelector('.main-content').style.background = backgroundColor;
      document.querySelector('.toolbar').style.background = surfaceColor;
      
      const primaryButtons = document.querySelectorAll('.btn-primary');
      primaryButtons.forEach(btn => {
        btn.style.backgroundColor = primaryColor;
      });

      const successButtons = document.querySelectorAll('.btn-success');
      successButtons.forEach(btn => {
        btn.style.backgroundColor = secondaryColor;
      });

      const dangerButtons = document.querySelectorAll('.btn-danger');
      dangerButtons.forEach(btn => {
        btn.style.backgroundColor = accentColor;
      });
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [
          {
            get: () => config.background_color || defaultConfig.background_color,
            set: (value) => {
              if (window.elementSdk) {
                window.elementSdk.setConfig({ background_color: value });
              }
            }
          },
          {
            get: () => config.surface_color || defaultConfig.surface_color,
            set: (value) => {
              if (window.elementSdk) {
                window.elementSdk.setConfig({ surface_color: value });
              }
            }
          },
          {
            get: () => config.primary_color || defaultConfig.primary_color,
            set: (value) => {
              if (window.elementSdk) {
                window.elementSdk.setConfig({ primary_color: value });
              }
            }
          },
          {
            get: () => config.secondary_color || defaultConfig.secondary_color,
            set: (value) => {
              if (window.elementSdk) {
                window.elementSdk.setConfig({ secondary_color: value });
              }
            }
          },
          {
            get: () => config.accent_color || defaultConfig.accent_color,
            set: (value) => {
              if (window.elementSdk) {
                window.elementSdk.setConfig({ accent_color: value });
              }
            }
          }
        ],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ['app_title', config.app_title || defaultConfig.app_title]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99ced37c91e6526d',t:'MTc2Mjg3NDk3Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>